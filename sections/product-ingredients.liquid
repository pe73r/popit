{% if product.tags contains "sommeil" %}
  {% assign product_color = "#4F2674" %}
  {% assign bg_color = "#EBD2E6" %}

{% elsif product.tags contains "energie" %}
  {% assign product_color = "#EA5B0C" %}
  {% assign bg_color = "#FFE6C8" %}

{% elsif product.tags contains "alimentation" %}
  {% assign product_color = "#3C915A" %}
  {% assign bg_color = "#D7E6AF" %}

{% elsif product.tags contains "sport" %}
  {% assign product_color = "#2F52A0" %}
  {% assign bg_color = "#CBE7E6" %}

{% elsif product.tags contains "stress" %}
  {% assign product_color = "#2D286E" %}
  {% assign bg_color = "#B7E1F5" %}

{% elsif product.tags contains "feminim" %}
  {% assign product_color = "#A01450" %}
  {% assign bg_color = "#FACDDC" %}

{% elsif product.tags contains "peau" or product.tags contains "hair" or product.tags contains "beaute" %}
  {% assign product_color = "#E4003A" %}
  {% assign bg_color = "#FBDBDC" %}

{% elsif product.tags contains "focus" %}
  {% assign product_color = "#00555A" %}
  {% assign bg_color = "#C3E6DC" %}
{% else %}
  {% assign product_color = section.settings.color %}
  {% assign bg_color = section.settings.bg_color %}
{% endif %}

<div class="w-full py-10 lg:py-14 lg:w-11/12 lg:mx-auto max-w-7xl">
  <h2 class="w-11/12 mx-auto text-2xl md:text-3xl mb-8 text-center product-ingredients-title">{{ section.settings.title }}</h2>
  <!-- mobile -->
  <div class="flex lg:hidden lg:justify-center relative overflow-hidden overflow-x-scroll snap-mandatory snap-x gap-4 lg:gap-6 xl:gap-8 scrollbar-none px-4">
    {% assign i = 0 %}
    {% for block in section.blocks %}
      {% assign i = i | plus: 1 %}

      {% assign pre_title = '_title' | prepend: i %}
      {% assign title = "ingredient_" | append: pre_title %}
      {% assign metafield_title = product.metafields.product[title] %}

      {% assign pre_bullet = '_bullet' | prepend: i %}
      {% assign bullet = "ingredient_" | append: pre_bullet %}
      {% assign bullet_1 = bullet | append: "_1" %}
      {% assign bullet_2 = bullet | append: "_2" %}
      {% assign bullet_3 = bullet | append: "_3" %}
      {% assign bullet_4 = bullet | append: "_4" %}
      {% assign bullet_5 = bullet | append: "_5" %}
      {% assign metafield_bullet_1 = product.metafields.product[bullet_1] %}
      {% assign metafield_bullet_2 = product.metafields.product[bullet_2] %}
      {% assign metafield_bullet_3 = product.metafields.product[bullet_3] %}
      {% assign metafield_bullet_4 = product.metafields.product[bullet_4] %}
      {% assign metafield_bullet_5 = product.metafields.product[bullet_5] %}


      {% assign pre_link = '_link' | prepend: i %}
      {% assign link_name = "ingredient_" | append: pre_link %}
      {% assign metafield_link = product.metafields.product[link_name] %}

      {% if metafield_title != blank %}

        <div class="min-w-[300px] lg:min-w-0 shadow-md pt-8 pb-4 px-4 mb-5 rounded-lg flex flex-col justify-between min-h-[200px] h-fit">
          <div class="">
            <h5 class="block text-base mb-5">{{ metafield_title }}</h5>
            <ul class="product-ingredients-list">
              {% if metafield_bullet_1 != blank %}
                <li class="text-sm flex items-center mb-3">
                  <span class="mr-3">{% render 'icon-check', product_color: product_color, bg_color: bg_color %}</span>
                  {{ metafield_bullet_1 }}</li>
              {% endif %}
              {% if metafield_bullet_2 != blank %}
                <li class="text-sm flex items-center mb-3">
                  <span class="mr-3">{% render 'icon-check', product_color: product_color, bg_color: bg_color %}</span>
                  {{ metafield_bullet_2 }}</li>
              {% endif %}
              {% if metafield_bullet_3 != blank %}
                <li class="text-sm flex items-center mb-3">
                  <span class="mr-3">{% render 'icon-check', product_color: product_color, bg_color: bg_color %}</span>
                  {{ metafield_bullet_3 }}</li>
              {% endif %}
              {% if metafield_bullet_4 != blank %}
                <li class="text-sm flex items-center mb-3">
                  <span class="mr-3">{% render 'icon-check', product_color: product_color, bg_color: bg_color %}</span>
                  {{ metafield_bullet_4 }}</li>
              {% endif %}
              {% if metafield_bullet_5 != blank %}
                <li class="text-sm flex items-center mb-3">
                  <span class="mr-3">{% render 'icon-check', product_color: product_color, bg_color: bg_color %}</span>
                  {{ metafield_bullet_5 }}</li>
              {% endif %}
            </ul>
          </div>
          {% if metafield_link != blank %}
            <div class="mt-4">
              <a href="{{ metafield_link }}" class="text-sm underline text-gray-300">En savoir plus</a>
            </div>
          {% endif %}
        </div>

      {% endif %}
    {% endfor %}

  </div>

  <!-- desktop -->
  <div class="hidden lg:block">
    <tail-carousel slidesToShow="xs:1 md:3 lg:3">
      <carousel-container>
        <carousel-content class="w-full">
          {% assign i = 0 %}
          {% for block in section.blocks %}
            {% assign i = i | plus: 1 %}

            {% assign pre_title = '_title' | prepend: i %}
            {% assign title = "ingredient_" | append: pre_title %}
            {% assign metafield_title = product.metafields.product[title] %}

            {% assign pre_bullet = '_bullet' | prepend: i %}
            {% assign bullet = "ingredient_" | append: pre_bullet %}
            {% assign bullet_1 = bullet | append: "_1" %}
            {% assign bullet_2 = bullet | append: "_2" %}
            {% assign bullet_3 = bullet | append: "_3" %}
            {% assign bullet_4 = bullet | append: "_4" %}
            {% assign bullet_5 = bullet | append: "_5" %}
            {% assign metafield_bullet_1 = product.metafields.product[bullet_1] %}
            {% assign metafield_bullet_2 = product.metafields.product[bullet_2] %}
            {% assign metafield_bullet_3 = product.metafields.product[bullet_3] %}
            {% assign metafield_bullet_4 = product.metafields.product[bullet_4] %}
            {% assign metafield_bullet_5 = product.metafields.product[bullet_5] %}


            {% assign pre_link = '_link' | prepend: i %}
            {% assign link_name = "ingredient_" | append: pre_link %}
            {% assign metafield_link = product.metafields.product[link_name] %}

            {% if metafield_title != blank %}
              <carousel-panel class="px-2">
                <div class="shadow-md pt-8 pb-4 px-4 mb-5 rounded-lg min-h-[300px]">
                  <div class="flex flex-col justify-between h-full">
                    <div>
                      <h5 class="block text-base mb-5">{{ metafield_title }}</h5>
                      <ul class="product-ingredients-list">
                        {% if metafield_bullet_1 != blank %}
                          <li class="text-sm flex items-center mb-4">
                            <span class="mr-3">{% render 'icon-check', product_color: product_color, bg_color: bg_color %}</span>
                            {{ metafield_bullet_1 }}
                          </li>
                        {% endif %}
                        {% if metafield_bullet_2 != blank %}
                          <li class="text-sm flex items-center mb-4">
                            <span class="mr-3">{% render 'icon-check', product_color: product_color, bg_color: bg_color %}</span>
                            {{ metafield_bullet_2 }}</li>
                        {% endif %}
                        {% if metafield_bullet_3 != blank %}
                          <li class="text-sm flex items-center mb-4">
                            <span class="mr-3">{% render 'icon-check', product_color: product_color, bg_color: bg_color %}</span>
                            {{ metafield_bullet_3 }}</li>
                        {% endif %}
                        {% if metafield_bullet_4 != blank %}
                          <li class="text-sm flex items-center mb-4">
                            <span class="mr-3">{% render 'icon-check', product_color: product_color, bg_color: bg_color %}</span>
                            {{ metafield_bullet_4 }}</li>
                        {% endif %}
                        {% if metafield_bullet_5 != blank %}
                          <li class="text-sm flex items-center mb-4">
                            <span class="mr-3">{% render 'icon-check', product_color: product_color, bg_color: bg_color %}</span>
                            {{ metafield_bullet_5 }}</li>
                        {% endif %}
                      </ul>
                    </div>
                    {% if metafield_link != blank %}
                      <div class="mt-4">
                        <a href="{{ metafield_link }}" class="text-sm underline text-gray-300">En savoir plus</a>
                      </div>
                    {% endif %}
                  </div>
                </div>
              </carousel-panel>
            {% endif %}
          {% endfor %}
        </carousel-content>
      </carousel-container>
      {% if section.settings.show_arrows %}
        <div class="flex justify-center gap-5 items-center mt-5">
          <carousel-prev class="arrow hidden md:flex justify-center items-center relative w-10 h-10 rounded-full z-[1] cursor-pointer disabled:opacity-50 disabled:cursor-auto">
            {% render 'icon-carousel-left', product_color: product_color %}
          </carousel-prev>
          <carousel-next class="arrow hidden md:flex justify-center items-center relative w-10 h-10 rounded-full z-[1] cursor-pointer disabled:opacity-50 disabled:cursor-auto">
            {% render 'icon-carousel-right', product_color: product_color %}
          </carousel-next>
        </div>
      {% endif %}

      {% if section.settings.show_dots %}
        <carousel-dots class="relative flex justify-center mt-10">
          <carousel-dot class="w-full h-[3px] transition-all bg-sable border-[1px] border-sable selected:bg-black selected:border-black selected:w-1/2"></carousel-dot>
        </carousel-dots>
      {% endif %}
    </tail-carousel>
  </div>
</div>
<style>
  .product-ingredients-title {
    color: {{ product_color }}
    ;
  }
  .arrow {
    background-color: {{ bg_color }}
    ;
  }
  carousel-prev:disabled,
  carousel-next:disabled {
    opacity: .5;
  }
  carousel-prev[disabled],
  carousel-next[disabled] {
    opacity: .5;
  }
</style>
{% schema %}

  {
    "name": "Product ingredients",
    "tag": "section",
    "settings": [
      {
        "type": "text",
        "id": "title",
        "label": "Title",
        "default": "Des ingrédients supérieurs"
      },
      {
        "type": "checkbox",
        "id": "show_arrows",
        "label": "Show arrows",
        "default": true
      },

      {
        "type": "header",
        "content": "colors"
      },
      {
        "type": "color",
        "id": "color",
        "label": "Text color",
        "default": "#4F2674"
      }, {
        "type": "color",
        "id": "bg_color",
        "label": "Pictos background color",
        "default": "#E9D2E7"
      }
    ],
    "blocks": [
      {
        "name": "block",
        "type": "block",
        "settings": [
          {
            "type": "text",
            "id": "title",
            "label": "Title",
            "default": "Magnésium"
          }
        ]
      }
    ]
  }
{% endschema %}